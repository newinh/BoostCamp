# Closure

- Overview
    - í´ë¡œì €ëž€?
    - í´ë¡œì €ì™€ í•¨ìˆ˜ì˜ ê´€ê³„
    - í´ë¡œì €ë§Œì˜ ê¸°ëŠ¥
- Expression
    - ê¸°ë³¸ í´ë¡œì € ë¬¸ë²•
    - ê¸°ë³¸ì˜ˆì œ
    - ê¸°ë³¸ í‘œí˜„ & í•¨ìˆ˜ ì´ìš©
    - íƒ€ìž… ìœ ì¶” (Inferring Type From Context)
    - ë‹¨ì¶• ì¸ìž ì´ë¦„ (Shorthand Argument Names)
    - ì•”ì‹œì  ë°˜í™˜í‘œí˜„ (Implicit Returns from Single-Expression Closures
    - ì—°ì‚°ìž í•¨ìˆ˜ (Operator Methods)
    - í›„í–‰ í´ë¡œì € (Trailling Closures)

- Capture
- í´ë¡œì €ëŠ” ì°¸ì¡°íƒ€ìž…
- Escape
- Auto Closure



## Overview

 ìŠ¤ìœ„í”„íŠ¸ì—ì„œ í•¨ìˆ˜í˜• í”„ë¡œê·¸ëž˜ë° íŒ¨ëŸ¬ë‹¤ìž„ì„ ì ‘í•  ë•Œ ì²« ê±¸ìŒìœ¼ë¡œ ê¼­ ì•Œì•„í– í•  ë…€ì„ì´ ë°”ë¡œ **í´ë¡œì €(Closure)**ì´ë‹¤.  

í•¨ìˆ˜í˜• í”„ë¡œê·¸ëž˜ë°ì˜ ì¤‘ìš”í•œ íŠ¹ì§•ì¤‘ í•˜ë‚˜ëŠ” í•¨ìˆ˜ë¥¼ [**ì¼ê¸‰ ê°ì²´ (First-class Citizen)**](./https://ko.wikipedia.org/wiki/ì¼ê¸‰_ê°ì²´)ë¡œ ë‹¤ë£¬ë‹¤ëŠ” ì ì´ë‹¤. ì¼ê¸‰ ê°ì²´ì˜ ì¡°ê±´ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

- ì „ë‹¬ì¸ìžë¡œ ì „ë‹¬í•  ìˆ˜ ìžˆë‹¤.
- ë™ì  í”„ë¡œí¼í‹° í• ë‹¹ì´ ê°€ëŠ¥í•˜ë‹¤.
- ë³€ìˆ˜ë‚˜ ë°ì´í„° êµ¬ì¡° ì•ˆì— ë‹´ì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
- ë°˜í™˜ ê°’ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
- í• ë‹¹í•  ë•Œ ì‚¬ìš©ëœ ì´ë¦„ê³¼ ê´€ê³„ì—†ì´ ê³ ìœ í•œ ê°ì²´ë¡œ êµ¬ë³„í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

í•¨ìˆ˜(ë™ìž‘)ë¥¼ ì „ë‹¬ì¸ìžë¡œ ì‚¬ìš©í•  ìˆ˜ë„ ìžˆê³ , ë³€ìˆ˜ì— í• ë‹¹í•˜ê±°ë‚˜ ë°˜í™˜í•  ìˆ˜ ìžˆë‹¤. ë‚´ê°€ ì¼ë°˜ì ìœ¼ë¡œ ë‹¤ë£¨ëŠ” ê°ì²´ì²˜ëŸ¼ ë‹¤ë£¨ ìˆ˜ ìžˆë‹¤..! ì •ë„ë¡œ í•´ì„í•  ìˆ˜ ìžˆê² ë‹¹ã…‡ã…‡. ì´ ì ì„ ì§šê³  í´ë¡œì €ë¡œ ë„˜ì–´ê°€ë³´ìž.


#### í´ë¡œì €ëž€?
- *Closures* are self-contained blocks of functionality that can be passed around and used in your code.
- ì¼ì •ê¸°ëŠ¥ì„ í•˜ëŠ” ì½”ë“œë¥¼ í•˜ë‚˜ì˜ ë¸”ë¡ìœ¼ë¡œ ëª¨ì•„ ë†“ì€ ê²ƒ.
- ì¤‘ê´„í˜¸ `{ }` ë¡œ ê°ì‹¸ì§„ ì‹¤í–‰ê°€ëŠ¥í•œ ì½”ë“œ ë¸”ëŸ­

#### í´ë¡œì €ì™€ í•¨ìˆ˜ì˜ ê´€ê³„
í•¨ìˆ˜ëŠ” í´ë¡œì €ì˜ í•œ í˜•íƒœ!   
í´ë¡œì €ë„ `() -> Void` ê¼´ì˜ íƒ€ìž…ì„ ê°–ëŠ”ë‹¤.
ì•„ëž˜ëŠ” í´ë¡œì €ì˜ 3ê°€ì§€ ëª¨ì–‘ì¸ë° í•¨ìˆ˜ëŠ” ê·¸ ì¤‘ í•˜ë‚˜ì˜ ëª¨ìŠµì— ì†í•œë‹¤.

- ì´ë¦„ì„ ê°€ì§€ë©´ì„œ ì–´ë–¤ ê°’ë„ íšë“í•˜ì§€ ì•ŠëŠ” ì „ì—­í•¨ìˆ˜ì˜ í˜•íƒœ
- ì´ë¦„ì„ ê°€ì§€ë©´ì„œ ë‹¤ë¥¸ í•¨ìˆ˜ ë‚´ë¶€ì˜ ê°’ì„ íšë“í•  ìˆ˜ ìžˆëŠ” ì¤‘ì²©ëœ í•¨ìˆ˜ì˜ í˜•íƒœ
- ì´ë¦„ì´ ì—†ê³  ì£¼ë³€ ë¬¸ë§¥ì— ë”°ë¼ ê°’ì„ íšë“í•  ìˆ˜ ìžˆëŠ” ì¶•ì–‘ ë¬¸ë²•ìœ¼ë¡œ ìž‘ì„±ëœ í˜•íƒœ

#### í´ë¡œì €ë§Œì˜ ì¤‘ìš”í•œ ê¸°ëŠ¥.   
*í´ë¡œì €*ëŠ” ë³€ìˆ˜ë‚˜ ìƒìˆ˜ê°€ ì„ ì–¸ëœ ìœ„ì¹˜ì—ì„œ **ì°¸ì¡°ë¥¼ íšë“**í•˜ê³  ì €ìž¥í•  ìˆ˜ ìžˆë‹¤.  
í´ë¡œì €ëŠ” ì—¬ê¸°ì„œ ì°©ì•ˆí•œ ì´ë¦„ì´ëž€ë‹¤.(ìž ê¸ˆ!)
![prisoner-jail](./prisoner-jail.jpg)


## Expression
ë§¤ìš°...ë§¤ìš°ë§¤ìš° ë‹¤ì–‘í•œ í‘œí˜„ë°©ë²•ì´ ìžˆë‹¤! ì¶•ì•½í˜•ì´ ë§Žê¸° ë•Œë¬¸ì¸ë“¯ã…‡ã…‡

#### ê¸°ë³¸ í´ë¡œì € ë¬¸ë²•

```swift
{
    (ë§¤ê°œë³€ìˆ˜ë“¤) -> ë°˜í™˜íƒ€ìž… in
    ì‹¤í–‰ ì½”ë“œ
}
```

ë°˜í™˜ê°’ì´ ìžˆë‹¤ë©´, return êµ¬ë¬¸ë„ ë“¤ì–´ìžˆê² ì§€. í´ë¡œì €ë„ í•¨ìˆ˜ì™€ ë§ˆì°¬ê°€ì§€ë¡œ *ìž…ì¶œë ¥ ë§¤ê°œë³€ìˆ˜*ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìžˆë‹¤(`inout`í‚¤ì›Œë“œëž‘ `&`ê¸°í˜¸ ë¶™ì´ëŠ”ê±°). ê·¸ëŸ¬ë‚˜ *ë§¤ê°œë³€ìˆ˜ ê¸°ë³¸ê°’*ì„ ì¤„ ìˆ˜ëŠ” ì—†ë‹¤. ê·¸ë ‡ë‹¤. 

#### ê¸°ë³¸ ì˜ˆì œ
ì•„ëž˜ ì˜ˆì œë¥¼ ì´ìš©í•´ì„œ í‘œí˜„ë²•ì„ ì•Œì•„ë³¼ê±°ìž„
```swift
let names = ["Chris", "Alex", "Ewa", "Barry", "Daniella"]
var reversedNames = names.sorted(by: (String, String) -> Bool)

// Declare
public func sorted(by areInIncreasingOrder: (Element, Element) -> Bool) -> [Element]
```

ë°°ì—´ì˜ *sorted ë©”ì„œë“œ*ë¥¼ ì´ìš©í•´ì„œ *í´ë¡œì €*ì˜ í‘œí˜„ë°©ë²•ì„ ì•Œì•„ë³¼ê±°ìž„. `names`ëŠ” `String`ë°°ì—´ì´ê³  ì—¬ê¸°ì„œ *sorted ë©”ì„œë“œ*ëŠ” *í´ë¡œì €*ë¥¼ ì „ë‹¬ë°›ê²Œë˜. 
ë°”ë¡œ `String` 2ê°œë¥¼ ë°›ì•„ì„œ `Bool`ì„ ë°˜í™˜í•˜ëŠ” *í´ë¡œì €*ë¥¼!  
ê·¸ëŸ¬ë©´ *sorted ë©”ì„œë“œ*ëŠ” ì •ë ¬ëœ `String` ë°°ì—´ì„ ë°˜í™˜í•˜ì§€.  

#### ê¸°ë³¸ í‘œí˜„ & í•¨ìˆ˜ ì´ìš©



```swift
// í•œì¤„ë¡œ ì¨ë„ ìƒê´€ ì—†ë‹¤.
var reversedNames = names.sorted(by: { 
    (s1: String, s2: String) -> Bool in
    return s1 > s2
})

// Stringí˜• 2ê°œë¥¼ ë°›ì•„ì„œ Boolí˜•ì„ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜
func backward(_ s1: String, _ s2: String) -> Bool {
    return s1 > s2
}
var reversedNames = names.sorted(by: backward)

// ["Ewa", "Daniella", "Chris", "Barry", "Alex"]
```

#### íƒ€ìž… ìœ ì¶” (Inferring Type From Context)
*sorted ë©”ì„œë“œ*ëŠ” `(String, String) -> Bool`ì„ ì›í•˜ë¯€ë¡œ  
ì»´íŒŒì¼ëŸ¬ëŠ” ì´ë¯¸ ëª¨ë“ ê²ƒì„ ì•Œê³ ìžˆë‹¤...`String`ì´ ë“¤ì–´ì˜¤ê³  `Bool`í˜•ì´ ë‚˜ê°ˆê²ƒìž„ì„!

```swift
reversedNames = names.sorted(by: { (s1, s2) in return s1 > s2 } )
```

#### ë‹¨ì¶• ì¸ìž ì´ë¦„ (Shorthand Argument Names)
ë°ì´í„° íƒ€ìž…ì´ ì—†ì–´ì§€ë‹ˆ `s1`, `s2`ê°™ì€ ë§¤ê°œë³€ìˆ˜ ì´ë¦„ë„ í•„ìš”ê°€ ì—†ë‹¤. ê·¸ëž˜ì„œ í•œë‹¤ ì œê³µ, ìŠ¤ìœ„í”„íŠ¸ëŠ” ë‹¨ì¶•ì¸ìžì´ë¦„ì„!ðŸ˜   
ë‹¨ì¶• ì¸ìžì´ë¦„ì€ ì²« ë²ˆì§¸ ì „ë‹¬ì¸ìžë¶€í„° `$0`, `$1`, `$2`,... ìˆœì„œì´ë‹¤.

```swift
// ì´ê±´ ì—ëŸ¬ 
reversedNames = names.sorted(by: { () in return $0 > $1 } )

reversedNames = names.sorted(by: { return $0 > $1 } )
```

#### ì•”ì‹œì  ë°˜í™˜í‘œí˜„ (Implicit Returns from Single-Expression Closures
 í´ë¡œì € ì‹¤í–‰ë¬¸ì´ **ë‹¨ í•œì¤„**ì´ë©´ ì•”ì‹œì ìœ¼ë¡œ ê·¸ ì‹¤í–‰ë¬¸ì´ ë°˜í™˜ê°’ìœ¼ë¡œ ì‚¬ìš©ë  ìˆ˜ ìžˆë‹¤.
```swift
reversedNames = names.sorted(by: { $0 > $1 } )
```

#### ì—°ì‚°ìž í•¨ìˆ˜ (Operator Methods)

ì—°ì‚°ìžë„ í•¨ìˆ˜ì˜ ì¼ì¢…ì´ì—ˆëŠ”ë° ìš°ë¦¬ê°€ ì§€ê¸ˆê¹Œì§€ *sorted(by: ) ë©”ì„œë“œ*ì— ì „ë‹¬í•œ í´ë¡œì €ì™€ ê°™ì€ íƒ€ìž…ì´ë‹¤.  
ê·¸ëž˜ì„œ!

```swift
reversedNames = names.sorted(by: > )

// Declare
public func ><T : Comparable>(lhs: T, rhs: T) -> Bool
```


#### í›„í–‰ í´ë¡œì € (Trailling Closures)
ë§ˆì§€ë§‰ ì „ë‹¬ì¸ìžë¡œ ìœ„ì¹˜í•˜ëŠ” í•¨ìˆ˜ì˜ ì†Œê´„í˜¸`( )`ë¥¼ ë‹«ê³  í´ë¡œì €ë¥¼ ìž‘ì„±í•´ë„ ëœë‹¤. ê²Œë‹¤ê°€ **ë‹¨ í•˜ë‚˜**ì˜ í´ë¡œì €ë§Œ ì „ë‹¬ì¸ìžë¡œ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ì—ëŠ” **ì†Œê´„í˜¸ë„ ìƒëžµí•  ìˆ˜ ìžˆë‹¤.** WoW

```swift
reversedNames = names.sorted{ $0 > $1 }
```


## ê°’ íšë“ (Capture)
## í´ë¡œì €ëŠ” ì°¸ì¡°íƒ€ìž…
## íƒˆì¶œ í´ë¡œì € (Escape)


## Auto Closure

í•¨ìˆ˜ì˜ ì „ë‹¬ì¸ìžë¡œ ì „ë‹¬ë˜ëŠ” í‘œí˜„ì„ ìžë™ìœ¼ë¡œ ë³€í™˜í•´ì£¼ëŠ” í´ë¡œì €.  
ìžë™ í´ë¡œì €ëŠ” ì „ë‹¬ì¸ìžë¥¼ ê°–ì§€ ì•ŠëŠ”ë‹¤.  
ìžë™í´ë¡œì €ëŠ” í˜¸ì¶œë˜ì—ˆì„ ë•Œ ìžì‹ ì´ ê°ì‹¸ê³  ìžˆëŠ” ì½”ë“œì˜ ê²°ê³¼ê°’ì„ ë°˜í™˜.  
ë¬¸ë²•ì ‘ íŽ¸ì˜ ì œê³µ  

 í ... ì¢€ ë‚œí•´í•˜ë‹¤....ì™œ ìžˆëŠ”ì§€ ì•„ì§ ìž˜ ëª¨ë¥´ê² ìŒã…œã…  ë©˜ë¶•ìž„. ë‹¤í–‰ì¸ê±´ ë³„ë¡œ ì“¸ì¼ ì—†ì„ê±°ëž˜ã…‹,ã…‹


í•¨ìˆ˜ê°€ ** ì „ë‹¬ì¸ìžê°€ ì—†ëŠ” í´ë¡œì €** ë¥¼ ì „ë‹¬ì¸ìžë¡œ ë°›ëŠ”ë‹¤.  
ê·¸ëž˜ì„œ ì•„ê¹Œë¶€í„° ì‚¬ìš©í–ˆë˜ `names.sroted(by:)` ì˜ˆì œë¥¼ ì“¸ìˆ˜ ì—†ë‹¤.

~~í´ë¡œì €ë¥¼ í†µí•´ ì§€ì—° ì—°ì‚°ì„ í•´ì•¼í•œë‹¤..?~~
~~í´ë¡œì €ì˜ ê¸°ëŠ¥ì¸ ê°’ íšë“ì€ ì“¸ìˆ˜ ì—†ì„ë“¯..?~~


```swift

var customerInLine: [String] = ["YongWha", "SangYong","SungHun", "Hami"]


func serveCustomer ( _ customerProvider:  () -> String ) {
    print("Now serving \(customerProvider())")
}
serveCustomer( { customerInLine.removeFirst() } ) // í•˜ë‚˜ ì§€ì›Œì§


////////////// ì•„ëž˜ëŠ” autoClosure ì ìš© /////// 

func autoClosureServeCustomer ( _ customerProvider: @autoclosure () -> String ) {
    print("Now serving \(customerProvider())")
}
autoClosureServeCustomer(  customerInLine.removeFirst()  ) // í•˜ë‚˜ ì§€ì›Œì§

```

ì±…ì— ìžˆëŠ” ë‚´ìš©
> ìžë™ í´ë¡œì € ì†ì„±ì„ ë¶€ì—¬í•œ ë§¤ê°œë³€ìˆ˜ëŠ” í´ë¡œì € ëŒ€ì‹ ì— customerInLine.removeFirst() ì½”ë“œì˜ ì‹¤í–‰ê²°ê³¼ì¸ String íƒ€ìž…ì˜ ë¬¸ìžì—´ì„ ì „ë‹¬ì¸ìžë¡œ ë°›ê²Œ ë©ë‹ˆë‹¤. String íƒ€ìž…ì˜ ê°’ì´ ìžë™ í´ë¡œì € ë§¤ê°œë³€ìˆ˜ì— ì „ë‹¬ë˜ë©´ String ê°’ì„ ë§¤ê°œë³€ìˆ˜ê°€ ì—†ëŠ” Stringê°’ì„ ë°˜í™˜í•œëŠ” í´ë¡œì €ë¡œ ë³€í™˜í•´ ì¤ë‹ˆë‹¤. String íƒ€ìž…ì˜ ê°’ì„ ì „ë‹¬ ë°›ëŠ” ì´ìœ ëŠ” ìžë™ í´ë¡œì €ì˜ ë°˜í™˜ íƒ€ìž…ì´ Stringì´ê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤. ìžë™í´ë¡œì €ëŠ” ì „ë‹¬ì¸ìžë¥¼ ê°–ì§€ ì•Šê¸° ë•Œë¬¸ì— ë°˜í™˜ íƒ€ìž…ì˜ ê°’ì´ ìžë™ í´ë¡œì €ì˜ ë§¤ê°œë³€ìˆ˜ë¡œ ì „ë‹¬ë˜ë©´ ì´ë¥¼ í´ë¡œì €ë¡œ ë°”ê¿”ì¤„ìˆ˜ ìžˆëŠ” ê²ƒìž…ë‹ˆë‹¤.

**ìžë™í´ë¡œì €ë¥¼ ì‚¬ìš©í•˜ë©´ ê¸°ì¡´ì˜ ì‚¬ìš© ë°©ë²•ì²˜ëŸ¼ í´ë¡œì €ë¥¼ ì „ë‹¬ì¸ìžë¡œ ë„˜ê²¨ì£¼ëŠ” ê²ƒì€ ë¶ˆê°€ëŠ¥ í•©ë‹ˆë‹¤.**  
ì—¬ê¸°ì„œ ë”ë”ìš± í˜¼ëž€ìž„ã…‹ã…‹ã…‹ã…‹ í•¨ìˆ˜ê°’ ì „ë‹¬í•˜ë“¯ì´ ì“°ë¼ëŠ” ë§ì¸ë°..

~~í´ë¡œì €ë¥¼ ì „ë‹¬í•˜ë„ë¡ êµ¬í˜„ëœ í•¨ìˆ˜ì— í•¨ìˆ˜ê²°ê³¼ê°’ì„ ë°”ë¡œ ë„˜ê²¨ì£¼ë„ë¡ ë³€í™”í•´ì£¼ëŠ” ê¸°ëŠ¥?~~ 

ë‹¤ì‹œí•œë²ˆ ì‚´íŽ´ë³´ìž.
```swift

var customerInLine: [String] = ["YongWha", "SangYong","SungHun", "Hami"]
 
func autoClosureServeCustomer ( _ customerProvider: @autoclosure () -> String ) {
    print("Now serving \(customerProvider())")
}

autoClosureServeCustomer(  customerInLine.removeFirst()  ) // í•˜ë‚˜ ì§€ì›Œì§

// ì´ëŸ° ëª¨ì–‘ì˜ í´ë¡œì €ë¡œ ì „ë‹¬ë˜ì–´ì„œ autoClosureServeCustomer í•¨ìˆ˜ë¡œ ê°€ëŠ”ë“¯ í•˜ë‹¤. 
let _ : () -> String = {
    return customerInLine.removeFirst()
}
```

 












